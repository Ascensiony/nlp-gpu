2021-12-02 16:30:50,383 - 160444 - SETTINGS - Override dict (utils.py:23)
2021-12-02 16:30:50,384 - 160444 - INFO - {
    "name": "sum_mono"
} (utils.py:24)
2021-12-02 16:30:50,384 - 160444 - SETTINGS - trainor (utils.py:29)
2021-12-02 16:30:50,384 - 160444 - INFO - {
    "batch_size": 4,
    "early_stop": 10,
    "early_stop_metric": "ROUGE2",
    "epochs": 99,
    "eval_start": 0,
    "lr_decay": "ReduceLROnPlateau",
    "lr_decay_params": {
        "factor": 0.8,
        "min_lr": 1e-06,
        "patience": 1,
        "threshold_mode": "abs"
    },
    "optim_params": {
        "lr": 5e-05,
        "weight_decay": 0.0
    },
    "optimizer": "RAdam"
} (utils.py:30)
2021-12-02 16:30:50,385 - 160444 - SETTINGS - validator (utils.py:29)
2021-12-02 16:30:50,385 - 160444 - INFO - {
    "batch_size": 4,
    "beam_width": 8,
    "metrics": [
        "ROUGEL",
        "ROUGE2",
        "BLEU"
    ],
    "splits": [
        "validate"
    ]
} (utils.py:30)
2021-12-02 16:30:53,223 - 160444 - SETTINGS - DataLoader (utils.py:86)
2021-12-02 16:30:53,223 - 160444 - INFO - Seq2Seq
TextDataset
{
    "source": "src",
    "root": "data/RRS/mimic-cxr/",
    "file": "findings.tok",
    "max_len": 250,
    "Tokenizer": {
        "name_or_path": "data/RRS/huggingface/biomed_roberta_base",
        "vocab_size": 50265,
        "tokenizer_args": {
            "return_tensors": "pt",
            "padding": "max_length",
            "add_special_tokens": false,
            "truncation": true,
            "max_length": 128
        },
        "special_tokens": {
            "bos_token": "<s>",
            "eos_token": "</s>",
            "unk_token": "<unk>",
            "sep_token": "</s>",
            "pad_token": "<pad>",
            "cls_token": "<s>",
            "mask_token": "<mask>"
        }
    }
}
TextDataset
{
    "source": "tgt",
    "root": "data/RRS/mimic-cxr/",
    "file": "impression.tok",
    "max_len": 250,
    "Tokenizer": {
        "name_or_path": "data/RRS/huggingface/biomed_roberta_base",
        "vocab_size": 50265,
        "tokenizer_args": {
            "return_tensors": "pt",
            "padding": "max_length",
            "truncation": true,
            "max_length": 80
        },
        "special_tokens": {
            "bos_token": "<s>",
            "eos_token": "</s>",
            "unk_token": "<unk>",
            "sep_token": "</s>",
            "pad_token": "<pad>",
            "cls_token": "<s>",
            "mask_token": "<mask>"
        }
    }
} (utils.py:87)
2021-12-02 16:30:53,224 - 160444 - INFO - UsingRandomSampler (utils.py:93)
2021-12-02 16:30:58,245 - 160444 - SETTINGS - Model SumHugMono created (utils.py:55)
2021-12-02 16:30:58,245 - 160444 - INFO - SumHugMono
RobertaModel(RobertaConfig {
  "_name_or_path": "data/RRS/huggingface/biomed_roberta_base",
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "eos_token_id": 2,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "layer_norm_eps": 1e-05,
  "max_position_embeddings": 514,
  "model_type": "roberta",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 1,
  "position_embedding_type": "absolute",
  "transformers_version": "4.5.1",
  "type_vocab_size": 1,
  "use_cache": true,
  "vocab_size": 50265
}
)
RobertaForCausalLM(RobertaConfig {
  "_name_or_path": "data/RRS/huggingface/biomed_roberta_base",
  "add_cross_attention": true,
  "attention_probs_dropout_prob": 0.1,
  "bos_token_id": 0,
  "eos_token_id": 2,
  "gradient_checkpointing": false,
  "hidden_act": "gelu",
  "hidden_dropout_prob": 0.1,
  "hidden_size": 768,
  "initializer_range": 0.02,
  "intermediate_size": 3072,
  "is_decoder": true,
  "layer_norm_eps": 1e-05,
  "max_position_embeddings": 514,
  "model_type": "roberta",
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "pad_token_id": 1,
  "position_embedding_type": "absolute",
  "transformers_version": "4.5.1",
  "type_vocab_size": 1,
  "use_cache": true,
  "vocab_size": 50265
}
)
# parameters: 277.71M (277.71M learnable)
 (utils.py:66)
2021-12-02 16:30:58,266 - 160444 - SETTINGS - Optimizer RAdam created (utils.py:41)
2021-12-02 16:30:58,266 - 160444 - INFO - RAdam (
Parameter Group 0
    betas: (0.9, 0.999)
    buffer: [[None, None, None], [None, None, None], [None, None, None], [None, None, None], [None, None, None], [None, None, None], [None, None, None], [None, None, None], [None, None, None], [None, None, None]]
    eps: 1e-08
    lr: 5e-05
    weight_decay: 0.0
) (utils.py:47)
2021-12-02 16:30:58,274 - 160444 - SETTINGS - Training scheduler created (utils.py:149)
2021-12-02 16:30:58,274 - 160444 - INFO - TrainingScheduler (
ReduceLROnPlateau
{
    "factor": 0.8,
    "min_lr": 1e-06,
    "mode": "max",
    "patience": 1,
    "threshold_mode": "abs"
}
Early stopping
    early_stop_limit: 10
    metric_comp_func: <built-in function gt>
    mode: max
    current_best_metric: -inf
) (utils.py:154)
